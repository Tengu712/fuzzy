# Grammar

## Comment

`--`から行末はコメントとして扱われます。

## Sentence

Fuzzyの文は0か1個の主語、0か1個の動詞、0個以上の目的語列から構成されます。
主語と目的語は文あるいは値です。
また、それぞれの構成要素は空白あるいは改行によって区切られます。

例えば、次の文は、

```fuzzy
2 * 3 + 4
```

次のような木にパースされます。

- 主語: 1
- 動詞: *
  - 主語: 2
  - 動詞: +
    - 主語: 3

Fuzzyインタプリタは内側の文から評価します。
従って、上の文全体は14に評価されます。
しかし、一般的な感覚では`2 * 3 + 4`は10に評価されるべきです。
Fuzzyは文の構成を操作するために`,`と`;`が用意されています。

| 記号 | 意味 |
| --- | --- |
| `,` | 現時点の現在の階層を主語とする |
| `;` | 現時点の文全体を主語とする |

`,`を使う場合、次のように書けば10に評価されます。

```fuzzy
2 * 3, + 4
```

`;`は階層が深くなったときに有用に働きます。

```fuzzy
-- 2 * 3 + 4を主語に取るには2回,を付さなければならないが、
2 * 3 + 4,, !!
-- ;を使えば全体を主語に取れる。
2 * 3 + 4; !!
```

主語が存在しない場合、`()`と評価されます。

```fuzzy
, !> { "hello" !! } -- hello
```

Fuzzyは続く動詞を主語が持っていない場合、その時点で文を終わらせます。
また、`.`を付すことで明確に文を終わらせられます。

```fuzzy
-- 主語fooがbarを動詞として取れる場合、foo barは文を成す。
foo bar
-- 主語foo barがbazを動詞として取れる場合、foo bar bazは文を成す。
foo bar baz
-- .で文末を示すことで、bazは主語とみなされる。
foo bar. baz
```

## Block

Fuzzyには三種類のブロックがあります。
ブロックは0個以上の文を集めて主語となるものです。

| 種類 | 区切り記号 | 評価結果 |
| --- | --- | --- |
| 即時ブロック | `()` | 最後の文の評価結果 |
| 遅延ブロック | `{}` | 最後の文の評価結果 |
| 配列ブロック | `[]` | すべての文を集めた配列 |

```fuzzy
-- 即時ブロックの挙動
()     -- ()
(1 2)  -- 2
(1 2.) -- ()

-- 遅延ブロックの挙動
{} %     -- ()
{1 2} %  -- 2
{1 2.} % -- ()

-- 配列ブロック及び遅延ブロックの挙動
[]     -- []
[1 2]  -- [1 2]
[1 2.] -- [1 2 ()]
```

